<%= content_for(:title, @user.first_name) %>

<article id="user">
  <header>
     <h1 style="text-align: center;"> My Timecard </h1>
  </header>

<% @clocked_products %>
<h4 style="text-align: center;color: #428bca; font-size: 15px;">Products I've Clocked ( <%= @clocked_products.size %> ) </h4>



<div class="row" style="margin-right: 0px; margin-left: 0px; margin-top: 20px;">
<div class="span12 centered-pills">
  <nav> 
<ul class="nav nav-pills" role="tablist">
  <li class="active" style="margin-right: 15px;"><%= link_to 'List View', user_path, :class => "user-nav" %></li>
  <li style="margin-left: 15px;"><%= link_to 'Image View', users_image_path, :class => "user-nav" %></li>
</ul>
</nav> 

<div style="height: 80px; width: 250px; background-color: darkgrey; position: absolute">
<h4 style="text-align: center; padding-top: 10px" > SORT </h4>
 <%= sortable "name", "Product Name" %> <%= sortable "releasing_on", "Release Date" %> 
</div>

</div>
</div>

<div class="container" style="padding-left: 75px;padding-right: 75px;">
<table class="table-timecard" style="width: 50%; position: absolute; margin-top: 25px; border-collapse: separate;border-spacing: 0 .7em; left: 0" align="center">

  <thead >
      <caption>UPCOMING RELEASES</caption>
  </thead>
  <tbody>
   <% @clocked_products.upcoming.each do |product| %> 

      <tr style="height: 50px;">
        <td style="padding-top: 10.5px; position: absolute; left: 25px;"> 
          <% if @current_user.clocks.find_by(product_id: product.id) %> 
          <%= button_to product_clock_path(product, @current_user.clocks.find_by(product_id: product.id)), method: :delete do %> 
             <i class="glyphicon glyphicon-time" style= "color:red;"> </i>
          <% end %>           
          <% end %> 
        </td>



        <td style="cursor: pointer;background-color: rgb(87, 87, 87);border-radius: 8px; padding-left: 15px; position: absolute; left: 75px; height: 35px; width: 325px; color: white; padding-top: 7px;" data-link="<%= product_path(product) %>"> <%= product.name %> 

  </td>  

        <td style="cursor: pointer;background-color: rgb(167, 205, 249);border-radius: 8px; text-align: center; position: absolute; left: 300px; height: 35px; width: 190px; padding-top: 7px;" data-link="<%= product_path(product) %>"> <span style="color: black;"> <%= format_releasing_on(product) %> - </span>  <span style="color: red;"> <%= format_releasing_on_remaining(product) %> </span>  
       </td>   



      </tr>
    <% end %>
  </tbody>





  <thead>
  <caption>TBA</caption>
  </thead>

  <tbody>
   <% @clocked_products.tba.each do |product| %> 

      <tr style="height: 50px;">
        <td style="padding-top: 10.5px; position: absolute; left: 25px;"> 
          <% if @current_user.clocks.find_by(product_id: product.id) %> 
          <%= button_to product_clock_path(product, @current_user.clocks.find_by(product_id: product.id)), method: :delete do %> 
             <i class="glyphicon glyphicon-time" style= "color:red;"> </i>
          <% end %>           
          <% end %> 
        </td>



        <td style="cursor: pointer;background-color: rgb(87, 87, 87);border-radius: 8px; padding-left: 15px; position: absolute; left: 75px; height: 35px; width: 325px; color: white; padding-top: 7px;" data-link="<%= product_path(product) %>"> <%= product.name %> 

  </td>  

        <td style="cursor: pointer;background-color: rgb(167, 205, 249);border-radius: 8px; text-align: center; position: absolute; left: 300px; height: 35px; width: 190px; padding-top: 7px;" data-link="<%= product_path(product) %>"> <span style="color: black;"> <%= format_releasing_on(product) %> - </span>  <span style="color: red;"> <%= format_releasing_on_remaining(product) %> </span>  
       </td>   



      </tr>
    <% end %>
  </tbody>
</table>
</table>



</div>




<table class="table-timecard" style="position: absolute; right: 10px; top: 225px; width: 50%; margin-top: 25px; border-collapse: separate;
    border-spacing: 0 .7em;" align="center">


  <thead>
   <caption>ALREADY OUT</caption>
  </thead>
  <tbody>
   <% @clocked_products.past.reverse.each do |product| %> 

      <tr style="height: 50px;">
        <td style="padding-top: 10.5px; position: absolute; left: 25px;"> 
          <% if @current_user.clocks.find_by(product_id: product.id) %> 
          <%= button_to product_clock_path(product, @current_user.clocks.find_by(product_id: product.id)), method: :delete do %> 
             <i class="glyphicon glyphicon-time" style= "color:red;"> </i>
          <% end %>           
          <% end %> 
        </td>



        <td style="cursor: pointer;background-color: rgb(87, 87, 87);border-radius: 8px; padding-left: 15px; position: absolute; left: 75px; height: 35px; width: 325px; color: white; padding-top: 7px;" data-link="<%= product_path(product) %>"> <%= product.name %> 

  </td>  

        <td style="cursor: pointer;background-color: rgb(167, 205, 249);border-radius: 8px; text-align: center; position: absolute; left: 300px; height: 35px; width: 190px; padding-top: 7px;" data-link="<%= product_path(product) %>"> <span style="color: black;"> <%= format_releasing_on(product) %> - </span>  <span style="color: red;"> <%= format_releasing_on_remaining(product) %> </span>  
       </td>   



      </tr>
    <% end %>
  </tbody>
</table>
</div>









<footer>
  <nav>
    <% if current_user_admin? %>
    <hr style="border-color: #000; border: solid 1px;">
      <p style="padding-left: 44%;">
      <%= link_to 'Delete Account', @user, :method => :delete, :confirm => 'Are you sure?', :class => 'btn btn-mini btn-danger' %>
        </td>
      <% end %> 
    </p>
  </nav>
</footer>
</article>



<script>
$(function() {
  return $(document).on('click', 'td[data-link]', function(evt) {
    return window.location = this.dataset.link;
  });
});
</script>

